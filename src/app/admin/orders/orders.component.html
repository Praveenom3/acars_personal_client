<div class="page-header-band-breadcrumbs">

    <div class="blue-breadcrumb col-md-12 padding-0">
        <a class="breadcrumb-back-btn cursor-pointer">
            <i aria-hidden="true" class="fa fa-angle-left"></i>
        </a>
        <ul class="list-unstyled breadcrumb header-breadcrumb">
            <li>
                <a href="javascript: void(0);">Actions</a>
            </li>
            <li>
                <a href="javascript: void(0);">Orders</a>
            </li>
        </ul>
    </div>

</div>

<div class="page-content col-md-12 section-page-content">
    <div class="container">

        <div class="col-md-12">
            <div class="col-xs-12">
                <div class="col-xs-12 widget widget-two no-padding">
                    <div class="widget-header-11" style="height:59px;">
                        <div style="float: left;margin-top: 9px;">
                            <strong>Clients</strong>
                        </div>
                        <div style="float: right;" *ngIf="hasFinancialRights">
                            <a class="btn btn-modal-blue" role="button" (click)="openModal('addClientModal')"><i class="fa fa-plus"></i> Add Client</a>
                        </div>
                    </div>

                    <div class="clearfix">
                        <div class="form-inline">
                            <div class="form-group pull-right padding-10">
                                <label for="email"><b>Search:</b></label>
                                <input class="form-control mr-left-5" [(ngModel)]="filterQuery" />
                            </div>
                        </div>
                        <table class="table table-hover table-bordered table-striped" [mfData]="clientsTableData | ordersFilter : filterQuery" #mf="mfDataTable"
                            [mfRowsOnPage]="rowsOnPage" [(mfSortBy)]="sortBy" [(mfSortOrder)]="sortOrder">

                            <thead>
                                <tr class="tr-blue-grid-head">
                                    <th class="text-center">
                                        <mfDefaultSorter by="client_number">Client #</mfDefaultSorter>
                                    </th>
                                    <th class="text-center">
                                        <mfDefaultSorter by="client_name">Client Name</mfDefaultSorter>
                                    </th>
                                    <th class="text-center">
                                        <mfDefaultSorter by="brand_id">Brand</mfDefaultSorter>
                                    </th>
                                    <th class="text-center">
                                        <mfDefaultSorter by="totalPurchaseCount"># of Purchases</mfDefaultSorter>
                                    </th>
                                </tr>
                            </thead>
                            <tbody>
                                <ng-container *ngIf="mf.data?.length">

                                    <tr *ngFor="let item of mf.data">
                                        <td class="text-center">{{item.client_number}}</td>
                                        <td class="text-center"><a class="link-blue-underline" (click)="openModal('updateClientModal', item)">{{item.client_name}}</a></td>
                                        <td class="text-center">{{getItemName('brand',item.brand_id)}}</td>
                                        <td class="text-center">{{item.totalPurchaseCount}}</td>
                                    </tr>
                                </ng-container>
                                <tr class="tr-text-center" *ngIf=!mf.data?.length>
                                    <td colspan="4">
                                        No records are found
                                    </td>
                                </tr>
                            </tbody>
                            <tfoot>
                                <tr>
                                    <td colspan="5">
                                        <mfBootstrapPaginator [rowsOnPageSet]="[5,10,15]"></mfBootstrapPaginator>
                                    </td>
                                </tr>
                            </tfoot>
                        </table>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Add Client Modal -->

<div class="modal fade" bsModal #addClientModal="bs-modal" [config]="{backdrop: 'static'}" role="dialog" aria-labelledby="addClientDetails"
    aria-hidden="true">
    <div class="modal-dialog modal-lg" style="width:75%;">
        <div class="modal-content">
            <div class="modal-header modal-header-color">

                <button type="button" class="close-modal modal-opacity close-modal-blue" (click)="closeModal('addClientModal')">
								X
							</button>
                <h4 class="modal-title color-white" id="myModalLabel">
                    Add Client Details
                </h4>
            </div>
            <form [formGroup]="_addClientForm" (ngSubmit)="onSubmit(this._addClientForm)">
                <div class="modal-body row">
                    <div class="col-xs-12">
                        <div class="col-md-12 padding-0 red">
                            {{_errorMessage}}
                        </div>
                        <table class="col-xs-12">
                            <tr>
                                <td style="width:13%;" [ngClass]="{'has-danger': !_isValid(this._addClientForm, this._addClientFormErrors,'client_name')}"><label class="form-control-label">Client Name : <span class="red">*</span></label></td>
                                <td style="width:22%;" [ngClass]="{'has-danger': !_isValid(this._addClientForm, this._addClientFormErrors,'client_name')}"><input type="text" maxlength="34" class="form-control" style="width: 90%;" oninput="this.value=this.value.replace(/[^A-Za-z0-9& ]/g, '')"
                                        [(ngModel)]="temp_client_name" [formControl]="_addClientForm.controls['client_name']"
                                        [ngClass]="{'form-control-danger': !_isValid(this._addClientForm, this._addClientFormErrors,'client_name')}"></td>
                                <td style="width:13%;" [ngClass]="{'has-danger': !_isValid(this._addClientForm, this._addClientFormErrors,'brand_id')}"><label class="form-control-label">Select Brand : <span class="red">*</span></label></td>
                                <td style="width:22%;" [ngClass]="{'has-danger': !_isValid(this._addClientForm, this._addClientFormErrors,'brand_id')}">

                                    <select class="form-control" [ngModel]="temp_brand_id" [formControl]="_addClientForm.controls['brand_id']" [ngClass]="{'form-control-danger': !_isValid(this._addClientForm, this._addClientFormErrors,'brand_id')}"
                                        (ngModelChange)="onBrandChange(this._addClientForm, $event)" style="width:90%;">
                                        <option value='' [ngValue]='' selected>Select</option>
                                        <option *ngFor="let ab of availableBrands" [ngValue]="ab">{{ab.brand_name}}</option>
                                    </select>
                                    <td style="width:10%;"><label class="control-label">Client # :</label></td>
                                    <td style="width:20%;">
                                        <input type="text" readOnly class="form-control" value="{{temp_client_number}}" [formControl]="_addClientForm.controls['client_number']"
                                            [ngClass]="{'form-control-danger': !_isValid(this._addClientForm, this._addClientFormErrors,'client_number')}">

                                    </td>
                            </tr>
                            <tr>
                                <td></td>
                                <td>
                                    <span class="help-block help-block-error" *ngIf="!_addClientFormErrors.client_name.valid">{{_addClientFormErrors.client_name.message}}</span>
                                </td>
                                <td></td>
                                <td>
                                    <span class="help-block help-block-error" *ngIf="!_addClientFormErrors.brand_id.valid">{{_addClientFormErrors.brand_id.message}}</span>
                                </td>
                                <td></td>
                                <td>
                                    <span class="help-block help-block-error" *ngIf="!_addClientFormErrors.client_number.valid">{{_addClientFormErrors.client_number.message}}</span>
                                </td>
                            </tr>
                        </table>
                    </div>

                    <!-- Purchase history -->
                    <div class="col-xs-12 padding-top-20">

                        <div class="col-xs-12 widget widget-two no-padding">
                            <div class="widget-header-11" style="height:59px;">
                                <div style="float: left;margin-top: 9px;">
                                    <strong>Purchase History</strong>
                                </div>
                                <div style="float: right;">
                                    <button type="button" class="btn btn-modal-blue pull-right" (click)="openModal('addPurchaseModal')" [disabled]="!_addClientForm.valid || _addClientFormSubmitted == true"><i class="fa fa-plus"></i> Add Purchase</button>
                                </div>
                            </div>

                            <div class="table-responsive">
                                <table class="table table-hover table-bordered table-striped" [mfData]="totalPurchases" #addPurchaseHist="mfDataTable" [mfRowsOnPage]="rowsOnPage"
                                    [(mfSortBy)]="sortBy" [(mfSortOrder)]="sortOrder">

                                    <thead>
                                        <tr class="tr-blue-grid-head">
                                            <th class="text-center">
                                                <mfDefaultSorter by="date">Purchase Date</mfDefaultSorter>
                                            </th>
                                            <th class="text-center">
                                                <mfDefaultSorter by="product">Product</mfDefaultSorter>
                                            </th>
                                            <th class="text-center">
                                                <mfDefaultSorter by="first_name">First Name</mfDefaultSorter>
                                            </th>
                                            <th class="text-center">
                                                <mfDefaultSorter by="last_name">Last Name</mfDefaultSorter>
                                            </th>
                                            <th class="text-center">
                                                <mfDefaultSorter by="email">Email</mfDefaultSorter>
                                            </th>
                                            <th class="text-center" style="min-width:120px;">
                                                <mfDefaultSorter by="contact_num">Contact #</mfDefaultSorter>
                                            </th>
                                            <th class="text-center">
                                                <mfDefaultSorter by="amount">Amount</mfDefaultSorter>
                                            </th>
                                            <th class="text-center">
                                                <mfDefaultSorter by="invoice_num">Invoice #</mfDefaultSorter>
                                            </th>
                                            <th class="text-center">
                                                <mfDefaultSorter by="invoice_paid">Invoice paid</mfDefaultSorter>
                                            </th>
                                            <th class="text-center">
                                                <mfDefaultSorter by="invoice_created_at">Invoice Date</mfDefaultSorter>
                                            </th>
                                            <th class="text-center">
                                                <mfDefaultSorter>Actions</mfDefaultSorter>
                                            </th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <ng-container *ngIf="addPurchaseHist.data?.length">
                                            <tr *ngFor="let item of addPurchaseHist.data">
                                                <td class="text-center">{{item.purchase_date | date: 'MM/dd/yyyy'}}</td>
                                                <td class="text-center"><a class="link-blue-underline" (click)="openModal('updatePurchaseModal', item)">{{getItemName("product", item.product_id)}}</a></td>
                                                <td class="text-center">{{item.purchaser_first_name}}</td>
                                                <td class="text-center">{{item.purchaser_last_name}}</td>
                                                <td class="text-center">{{item.purchaser_email}}</td>
                                                <td class="text-center">{{formatPhoneNumber(item.purchaser_mobile)}}</td>
                                                <td class="text-center">{{item.amount}}</td>
                                                <td class="text-center">{{item.invoice_no}}</td>
                                                <td class="text-center">{{(item.is_invoice == 1 || item.is_invoice == '1') ? ((item.is_invoice_paid == 1 || item.is_invoice_paid == '1') ? 'Yes':'No'): 'Yes'}}</td>
                                                <td class="text-center">{{item.invoice_created_at | date: 'MM/dd/yyyy'}}</td>
                                                <td class="text-center"><a class="red" (click)=removePurchase(item)><i class="fa fa-trash"></i></a></td>

                                            </tr>
                                        </ng-container>
                                        <tr class="tr-text-center" *ngIf=!addPurchaseHist.data?.length>
                                            <td colspan="10">
                                                No records are found
                                            </td>
                                        </tr>
                                    </tbody>
                                    <tfoot>
                                        <tr>
                                            <td colspan="10">
                                                <mfBootstrapPaginator [rowsOnPageSet]="[5,10,15]"></mfBootstrapPaginator>
                                            </td>
                                        </tr>
                                    </tfoot>
                                </table>
                            </div>
                        </div>
                    </div>
                    <!-- ./Purchase history -->
                </div>
                <div class="modal-footer footer-background">
                    <a class="red hover-red" *ngIf="newPurchases.length > 0">Data unsaved.</a>
                    <button type="submit" class="btn btn-primary btn-blue" [disabled]="!(_addClientForm.valid && totalPurchases.length > 0 ) || _addClientFormSubmitted == true">
                        <i *ngIf="_addClientFormSubmitted == true" class="fa fa-circle-o-notch fa-spin fa-fw"></i> Save</button>
                    <button type="button" class="btn btn-default" (click)="closeModal('addClientModal')">Close</button>
                </div>
            </form>
        </div>
    </div>
</div>
<!-- Add Client Modal -->


<!-- Update Client Modal -->
<div class="modal fade" bsModal #updateClientModal="bs-modal" [config]="{backdrop: 'static'}" role="dialog" aria-labelledby="updateClientDetails"
    aria-hidden="true">
    <div class="modal-dialog modal-lg" style="width:75%;">
        <div class="modal-content">
            <div class="modal-header modal-header-color">

                <button type="button" class="close-modal modal-opacity close-modal-blue" (click)="closeModal('updateClientModal')">
								X
							</button>
                <h4 class="modal-title color-white" id="myModalLabel">
                    Update Client Details
                </h4>
            </div>
            <form [formGroup]="_updateClientForm" (ngSubmit)="onSubmit(this._updateClientForm)">
                <div class="modal-body row">
                    <div class="col-xs-12">
                        <div class="col-md-12 padding-0 red">
                            {{_errorMessage}}
                        </div>
                        <table class="col-xs-12">
                            <tr>
                                <td style="width:13%;" [ngClass]="{'has-danger': !_isValid(this._updateClientForm, this._updateClientFormErrors, 'client_name')}"><label class="form-control-label">Client Name : <span class="red">*</span></label></td>
                                <td style="width:22%;" [ngClass]="{'has-danger': !_isValid(this._updateClientForm, this._updateClientFormErrors, 'client_name')}">
                                    <input type="text" maxlength="34" class="form-control" style="width: 90%;" *ngIf="hasFinancialRights" oninput="this.value=this.value.replace(/[^A-Za-z& ]/g, '')"
                                        [(ngModel)]="temp_client_name" [formControl]="_updateClientForm.controls['client_name']"
                                        [ngClass]="{'form-control-danger': !_isValid(this._updateClientForm, this._updateClientFormErrors, 'client_name')}">
                                    <span *ngIf="!hasFinancialRights" class="form-control" style="width: 90%;" readOnly>{{_updateClientForm.controls['client_name'].value}}</span>
                                </td>
                                <td style="width:13%;" [ngClass]="{'has-danger': !_isValid(this._updateClientForm, this._updateClientFormErrors, 'brand_id')}"><label class="form-control-label">Select Brand : <span class="red">*</span></label></td>
                                <td style="width:22%;" [ngClass]="{'has-danger': !_isValid(this._updateClientForm, this._updateClientFormErrors, 'brand_id')}">

                                    <select class="form-control" *ngIf="hasFinancialRights" [ngModel]="temp_brand_id" [formControl]="_updateClientForm.controls['brand_id']"
                                        [ngClass]="{'form-control-danger': !_isValid(this._updateClientForm, this._updateClientFormErrors, 'brand_id')}"
                                        (ngModelChange)="onBrandChange(this._updateClientForm, $event)" style="width:90%;">
                                        <option value='' [ngValue]='' selected>Select</option>
                                        <option *ngFor="let ab of availableBrands" [value]="ab.brand_id" [ngValue]="ab">{{ab.brand_name}}</option>
                                    </select>
                                    <span *ngIf="!hasFinancialRights" class="form-control" style="width: 90%;" readOnly>{{this.temp_brand}}</span>
                                    <td style="width:10%;"><label class="control-label">Client # :</label></td>
                                    <td style="width:20%;">
                                        <input type="text" readOnly class="form-control" value="{{temp_client_number}}" [formControl]="_updateClientForm.controls['client_number']"
                                            [ngClass]="{'form-control-danger': !_isValid(this._updateClientForm, this._updateClientFormErrors, 'client_number')}">

                                    </td>
                            </tr>
                            <tr>
                                <td></td>
                                <td>
                                    <span class="help-block help-block-error" *ngIf="!_updateClientFormErrors.client_name.valid">{{_updateClientFormErrors.client_name.message}}</span>
                                </td>
                                <td></td>
                                <td>
                                    <span class="help-block help-block-error" *ngIf="!_updateClientFormErrors.brand_id.valid">{{_updateClientFormErrors.brand_id.message}}</span>
                                </td>
                                <td></td>
                                <td>
                                    <span class="help-block help-block-error" *ngIf="!_updateClientFormErrors.client_number.valid">{{_updateClientFormErrors.client_number.message}}</span>
                                </td>
                            </tr>
                        </table>
                    </div>

                    <!-- Purchase history -->
                    <div class="col-xs-12 padding-top-20">

                        <div class="col-xs-12 widget widget-two no-padding">
                            <div class="widget-header-11" style="height:59px;">
                                <div style="float: left;margin-top: 9px;">
                                    <strong>Purchase History</strong>
                                </div>
                                <div style="float: right;" *ngIf="hasFinancialRights">
                                    <button type="button" class="btn btn-modal-blue pull-right" (click)="openModal('addPurchaseModal')" [disabled]="!_updateClientForm.valid || _updateClientFormSubmitted == true"><i class="fa fa-plus"></i> Add Purchase</button>
                                </div>
                            </div>

                            <div class="table-responsive">
                                <table class="table table-hover table-bordered table-striped" [mfData]="totalPurchases" #updatePurchaseHist="mfDataTable"
                                    [mfRowsOnPage]="rowsOnPage" [(mfSortBy)]="sortBy" [(mfSortOrder)]="sortOrder">

                                    <thead>
                                        <tr class="tr-blue-grid-head">
                                            <th class="text-center">
                                                <mfDefaultSorter by="date">Date</mfDefaultSorter>
                                            </th>
                                            <th class="text-center">
                                                <mfDefaultSorter by="product">Product</mfDefaultSorter>
                                            </th>
                                            <th class="text-center">
                                                <mfDefaultSorter by="first_name">First Name</mfDefaultSorter>
                                            </th>
                                            <th class="text-center">
                                                <mfDefaultSorter by="last_name">Last Name</mfDefaultSorter>
                                            </th>
                                            <th class="text-center">
                                                <mfDefaultSorter by="email">Email</mfDefaultSorter>
                                            </th>
                                            <th class="text-center" style="min-width:120px;">
                                                <mfDefaultSorter by="contact_num">Contact #</mfDefaultSorter>
                                            </th>
                                            <th class="text-center">
                                                <mfDefaultSorter by="amount">Amount</mfDefaultSorter>
                                            </th>
                                            <th class="text-center">
                                                <mfDefaultSorter by="invoice_num">Invoice #</mfDefaultSorter>
                                            </th>
                                            <th class="text-center">
                                                <mfDefaultSorter by="invoice_paid">Invoice paid</mfDefaultSorter>
                                            </th>
                                            <th class="text-center">
                                                <mfDefaultSorter by="invoice_created_at">Invoice Date</mfDefaultSorter>
                                            </th>
                                            <th class="text-center">
                                                <mfDefaultSorter>Actions</mfDefaultSorter>
                                            </th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <ng-container *ngIf="updatePurchaseHist.data?.length">
                                            <tr *ngFor="let item of updatePurchaseHist.data">
                                                <td class="text-center">{{item.purchase_date | date: 'MM/dd/yyyy'}}</td>
                                                <td class="text-center"><a class="link-blue-underline" (click)="openModal('updatePurchaseModal', item)">{{getItemName("product", item.product_id)}}</a></td>
                                                <td class="text-center">{{item.purchaser_first_name}}</td>
                                                <td class="text-center">{{item.purchaser_last_name}}</td>
                                                <td class="text-center">{{item.purchaser_email}}</td>
                                                <td class="text-center">{{ formatPhoneNumber(item.purchaser_mobile)}}</td>
                                                <td class="text-center">{{item.amount}}</td>
                                                <td class="text-center">{{item.invoice_no}}</td>
                                                <td class="text-center">{{(item.is_invoice == 1 || item.is_invoice == '1') ? ((item.is_invoice_paid == 1 || item.is_invoice_paid == '1') ? 'Yes':'No'): 'Yes'}}</td>
                                                <td class="text-center">{{item.invoice_created_at | date: 'MM/dd/yyyy'}}</td>
                                                <td class="text-center"><a class="red" (click)=removePurchase(item)><i class="fa fa-trash"></i></a></td>

                                            </tr>
                                        </ng-container>
                                        <tr class="tr-text-center" *ngIf=!updatePurchaseHist.data?.length>
                                            <td colspan="10">
                                                No records are found
                                            </td>
                                        </tr>
                                    </tbody>
                                    <tfoot>
                                        <tr>
                                            <td colspan="10">
                                                <mfBootstrapPaginator [rowsOnPageSet]="[5,10,15]"></mfBootstrapPaginator>
                                            </td>
                                        </tr>
                                    </tfoot>
                                </table>
                            </div>
                        </div>
                    </div>
                    <!-- ./Purchase history -->
                </div>
                <div class="modal-footer footer-background">
                    <a class="red hover-red" *ngIf="newPurchases.length > 0">Data unsaved.</a>
                    <button type="submit" class="btn btn-primary btn-blue" *ngIf="hasFinancialRights" [disabled]="!(_updateClientForm.valid && totalPurchases.length > 0 ) || _updateClientFormSubmitted == true">
                        <i *ngIf ="_updateClientFormSubmitted == true" class="fa fa-circle-o-notch fa-spin fa-fw"></i>Save</button>
                    <button type="button" class="btn btn-default" (click)="closeModal('updateClientModal')">Close</button>
                </div>
            </form>
        </div>
    </div>
</div>
<!-- Update Client Modal -->


<!-- Add Purchase Modal -->
<div class="modal fade" bsModal #addPurchaseModal="bs-modal" [config]="{backdrop: 'static'}" role="dialog" aria-labelledby="addPurchaseDetails"
    aria-hidden="true">
    <div class="modal-dialog modal-lg" style="width: 80%;">
        <div class="modal-content">
            <div class="modal-header modal-header-color">

                <button type="button" class="close-modal modal-opacity close-modal-blue" (click)="closeModal('addPurchaseModal')">
								X
							</button>
                <h4 class="modal-title color-white" id="myModalLabel">
                    Add Purchase Details
                </h4>
            </div>
            <form [formGroup]="_addPurchaseForm" (ngSubmit)="onSubmit(this._addPurchaseForm)" style="margin-top:10px;">

                <div class="modal-body row">
                    <div class="col-md-12 padding-0 red">
                        {{_errorMessage}}
                    </div>

                    <div class="col-md-12 padding-0">
                        <div class="col-md-4">
                            <div class="form-group required">
                                <label class="form-control-label">Client Name</label>
                                <span class="form-control" readOnly>{{temp_client_name}}</span>
                            </div>
                        </div>

                        <div class="col-md-4">
                            <div class="form-group required">
                                <label class="form-control-label">Brand</label>
                                <span class="form-control" readOnly>{{temp_brand}}</span>
                            </div>
                        </div>

                        <div class="col-md-4">
                            <div class="form-group required">
                                <label class="form-control-label">Client #</label>
                                <span class="form-control" readOnly>{{temp_client_number}}</span>
                            </div>
                        </div>

                    </div>
                    <div class="col-md-12 padding-0">

                        <div class="col-md-4">
                            <div class="form-group required" [ngClass]="{'has-danger': !_isValid(this._addPurchaseForm, this._addPurchaseFormErrors, 'product_id')}">
                                <label class="form-control-label">Product</label>
                                <select class="form-control" [formControl]="_addPurchaseForm.controls['product_id']" (ngModelChange)="onProductChange(this._addPurchaseForm, $event)"
                                    [ngClass]="{'form-control-danger': !_isValid(this._addPurchaseForm, this._addPurchaseFormErrors, 'product_id')}">
                                    <option value='' [ngValue]='' selected>Select</option>
                                    <ng-container *ngFor="let sp of selectableProducts">
                                        <option [value]="sp.product_id" *ngIf="sp.is_deleted == '0'">{{sp.product_full_name}}</option>
                                    </ng-container>
                                </select>

                                <span class="help-block help-block-error" *ngIf="!_addPurchaseFormErrors.product_id.valid">{{_addPurchaseFormErrors.product_id.message}}</span>

                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group required" [ngClass]="{'has-danger': !_isValid(this._addPurchaseForm, this._addPurchaseFormErrors, 'total_no_eins')}">
                                <label class="form-control-label">Total # of Eins</label>
                                <input type="number" min="0" oninput="this.value=this.value.slice(0,this.maxLength)" maxLength="3" class="form-control" [formControl]="_addPurchaseForm.controls['total_no_eins']"
                                   min="0" [ngClass]="{'form-control-danger': !_isValid(this._addPurchaseForm, this._addPurchaseFormErrors, 'total_no_eins')}">

                                <span class="help-block help-block-error" *ngIf="!_addPurchaseFormErrors.total_no_eins.valid">{{_addPurchaseFormErrors.total_no_eins.message}}</span>

                            </div>
                        </div>

                        <div class="col-md-4">
                            <div class="form-group" [ngClass]="{'has-danger': !_isValid(this._addPurchaseForm, this._addPurchaseFormErrors, 'total_no_forms'), 'required': !isVhtProduct}">

                                <label class="form-control-label">Total # of Forms</label>
                                <!-- <input type="number" min="0" oninput="this.value=this.value.slice(0,this.maxLength)" maxLength="6" class="form-control" [formControl]="_addPurchaseForm.controls['total_no_forms']" [ngClass]="{'form-control-danger': !_isValid(this._addPurchaseForm, this._addPurchaseFormErrors, 'total_no_forms')}"> -->
                                <select class="form-control" [formControl]="_addPurchaseForm.controls['total_no_forms']" [ngClass]="{'form-control-danger': !_isValid(this._addPurchaseForm, this._addPurchaseFormErrors, 'total_no_forms')}">
                                    <option value='' [ngValue]='' selected>Select</option>
                                    <option *ngFor="let nfl of no_of_forms_list" [value]="nfl.form_value" >{{nfl.form_name}}</option>
                                </select>
                                <span class="help-block help-block-error" *ngIf="!_addPurchaseFormErrors.total_no_forms.valid">{{_addPurchaseFormErrors.total_no_forms.message}}</span>

                            </div>
                        </div>
                    </div>
                    <div class="col-md-12 padding-0">

                        <div class="col-md-4">
                            <div class="form-group required" [ngClass]="{'has-danger': !_isValid(this._addPurchaseForm, this._addPurchaseFormErrors, 'purchaser_first_name')}">
                                <label class="form-control-label">Purchaser First Name</label>
                                <input type="text" oninput="this.value=this.value.replace(/[^A-Za-z ]/g, '')" maxlength="20" class="form-control" [formControl]="_addPurchaseForm.controls['purchaser_first_name']"
                                    [ngClass]="{'form-control-danger': !_isValid(this._addPurchaseForm, this._addPurchaseFormErrors, 'purchaser_first_name')}">

                                <span class="help-block help-block-error" *ngIf="!_addPurchaseFormErrors.purchaser_first_name.valid">{{_addPurchaseFormErrors.purchaser_first_name.message}}</span>

                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group required" [ngClass]="{'has-danger': !_isValid(this._addPurchaseForm, this._addPurchaseFormErrors, 'purchaser_last_name')}">
                                <label class="form-control-label">Purchaser Last Name</label>
                                <input type="text" oninput="this.value=this.value.replace(/[^A-Za-z ]/g, '')" maxlength="20" class="form-control" [formControl]="_addPurchaseForm.controls['purchaser_last_name']"
                                    [ngClass]="{'form-control-danger': !_isValid(this._addPurchaseForm, this._addPurchaseFormErrors, 'purchaser_last_name')}">

                                <span class="help-block help-block-error" *ngIf="!_addPurchaseFormErrors.purchaser_last_name.valid">{{_addPurchaseFormErrors.purchaser_last_name.message}}</span>

                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group required" [ngClass]="{'has-danger': !_isValid(this._addPurchaseForm, this._addPurchaseFormErrors, 'purchaser_email')}">
                                <label class="form-control-label">Purchaser Email</label>
                                <input type="text" class="form-control" maxlength="50" [formControl]="_addPurchaseForm.controls['purchaser_email']" [ngClass]="{'form-control-danger': !_isValid(this._addPurchaseForm, this._addPurchaseFormErrors, 'purchaser_email')}">

                                <span class="help-block help-block-error" *ngIf="!_addPurchaseFormErrors.purchaser_email.valid">{{_addPurchaseFormErrors.purchaser_email.message}}</span>

                            </div>
                        </div>
                    </div>
                    <div class="col-md-12 padding-0">

                        <div class="col-md-4">
                            <div class="form-group required" [ngClass]="{'has-danger': !_isValid(this._addPurchaseForm, this._addPurchaseFormErrors, 'purchaser_mobile')}">

                                <label class="form-control-label">Purchaser Phone</label>
                                <input type="text" [textMask]="{mask: mask,guide: false, modelClean: true}" [formControl]="_addPurchaseForm.controls['purchaser_mobile']"
                                    class="form-control" placeholder="(___) ___-____" [ngClass]="{'form-control-danger': !_isValid(this._addPurchaseForm, this._addPurchaseFormErrors, 'purchaser_mobile')}">

                                <span class="help-block help-block-error" *ngIf="!_addPurchaseFormErrors.purchaser_mobile.valid">{{_addPurchaseFormErrors.purchaser_mobile.message}}</span>

                            </div>
                        </div>

                        <div class="col-md-4">
                            <div class="form-group required" [ngClass]="{'has-danger': !_isValid(this._addPurchaseForm, this._addPurchaseFormErrors, 'purchase_status')}">

                                <label class="form-control-label">Purchased Status</label>
                                <div style="height:34px; padding-top:5px;">
                                    <label class="radio-inline">
                                        <input type="radio" name="purchasedStatus" [value]="1" [checked]="_addPurchaseForm.controls['purchase_status'].value==='1'" [formControl]="_addPurchaseForm.controls['purchase_status']" [ngClass]="{'form-control-danger': !_isValid(this._addPurchaseForm, this._addPurchaseFormErrors, 'purchase_status')}">Active
                                    </label>
                                    <label class="radio-inline">
                                        <input type="radio" name="purchasedStatus" [value]="0" [checked]="_addPurchaseForm.controls['purchase_status'].value==='0'" [formControl]="_addPurchaseForm.controls['purchase_status']" [ngClass]="{'form-control-danger': !_isValid(this._addPurchaseForm, this._addPurchaseFormErrors, 'purchase_status')}">Inactive
                                    </label>
                                </div>

                                <span class="help-block help-block-error" *ngIf="!_addPurchaseFormErrors.purchase_status.valid">{{_addPurchaseFormErrors.purchase_status.message}}</span>

                            </div>
                        </div>

                        <div class="col-md-4">
                            <div class="form-group required" [ngClass]="{'has-danger': !_isValid(this._addPurchaseForm, this._addPurchaseFormErrors, 'amount')}">
                                <label class="form-control-label">Amount</label>
                                <input type="text" OnlyAmountNumber="true" class="form-control" [formControl]="_addPurchaseForm.controls['amount']" DecimalPlaces="2"
                                    minValue="1.00" maxValue="999999.00" [ngClass]="{'form-control-danger': !_isValid(this._addPurchaseForm, this._addPurchaseFormErrors, 'amount')}">

                                <span class="help-block help-block-error" *ngIf="!_addPurchaseFormErrors.amount.valid">{{_addPurchaseFormErrors.amount.message}}</span>

                            </div>
                        </div>

                    </div>
                    <div class="col-md-12 padding-0">
                        <div class="col-md-4" *ngIf="show_account_manager == '1'">
                            <div class="form-group required" [ngClass]="{'has-danger': !_isValid(this._addPurchaseForm, this._addPurchaseFormErrors, 'account_manager')}">

                                <label class="form-control-label">Assign Account Manager</label>
                                <select class="form-control" [formControl]="_addPurchaseForm.controls['account_manager']" [ngClass]="{'form-control-danger': !_isValid(this._addPurchaseForm, this._addPurchaseFormErrors, 'account_manager')}">
                                    <option value='' [ngValue]='' selected>Select</option>
                                    <option *ngFor="let am of availableAcctManagers" [value]="am.admin_user_id" >{{am.first_name}} {{am.last_name}}</option>
                                </select>

                                <span class="help-block help-block-error" *ngIf="!_addPurchaseFormErrors.account_manager.valid">{{_addPurchaseFormErrors.account_manager.message}}</span>

                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group required" [ngClass]="{'has-danger': !_isValid(this._addPurchaseForm, this._addPurchaseFormErrors, 'purchase_date')}">

                                <label class="form-control-label">Date of Purchase</label>
                                <input type="date" max="9999-12-31" class="form-control" [formControl]="_addPurchaseForm.controls['purchase_date']" [ngClass]="{'form-control-danger': !_isValid(this._addPurchaseForm, this._addPurchaseFormErrors, 'purchase_date')}">

                                <span class="help-block help-block-error" *ngIf="!_addPurchaseFormErrors.purchase_date.valid">{{_addPurchaseFormErrors.purchase_date.message}}</span>

                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group required" [ngClass]="{'has-danger': !_isValid(this._addPurchaseForm, this._addPurchaseFormErrors, 'is_invoice')}">

                                <label class="form-control-label">Invoice</label>
                                <div style="height:34px; padding-top:5px;">
                                    <label class="radio-inline">
                                        <input type="radio" name="isInvoice" [value]="1" (click)="toggleInvoiceFieldsValidator(this._addPurchaseForm, true)" [checked]="_addPurchaseForm.controls['is_invoice'].value==='1'" [formControl]="_addPurchaseForm.controls['is_invoice']" [ngClass]="{'form-control-danger': !_isValid(this._addPurchaseForm, this._addPurchaseFormErrors, 'is_invoice')}">Yes
                                    </label>
                                    <label class="radio-inline">
                                        <input type="radio" name="isInvoice" [value]="0" (click)="toggleInvoiceFieldsValidator(this._addPurchaseForm, false)" [checked]="_addPurchaseForm.controls['is_invoice'].value==='0'" [formControl]="_addPurchaseForm.controls['is_invoice']" [ngClass]="{'form-control-danger': !_isValid(this._addPurchaseForm, this._addPurchaseFormErrors, 'is_invoice')}">No
                                    </label>
                                </div>

                                <span class="help-block help-block-error" *ngIf="!_addPurchaseFormErrors.is_invoice.valid">{{_addPurchaseFormErrors.is_invoice.message}}</span>

                            </div>
                        </div>
                        <div class="col-md-12 padding-0">
                            <div class="col-md-4" *ngIf="_addPurchaseForm.controls['is_invoice'].value == '1'">
                                <div class="form-group required" [ngClass]="{'has-danger': !_isValid(this._addPurchaseForm, this._addPurchaseFormErrors, 'invoice_no')}">
                                    <label class="form-control-label">Invoice #</label>
                                    <input type="text" invoiceNumber="true" maxlength="30" class="form-control" [formControl]="_addPurchaseForm.controls['invoice_no']" [ngClass]="{'form-control-danger': !_isValid(this._addPurchaseForm, this._addPurchaseFormErrors, 'invoice_no')}">

                                    <span class="help-block help-block-error" *ngIf="!_addPurchaseFormErrors.invoice_no.valid">{{_addPurchaseFormErrors.invoice_no.message}}</span>

                                </div>
                            </div>
                            <div class="col-md-4" *ngIf="_addPurchaseForm.controls['is_invoice'].value == '1'">
                                <div class="form-group required" [ngClass]="{'has-danger': !_isValid(this._addPurchaseForm, this._addPurchaseFormErrors, 'invoice_created_at')}">
                                    <label class="form-control-label">Invoice Date</label>
                                    <input type="date" max="9999-12-31" class="form-control" [formControl]="_addPurchaseForm.controls['invoice_created_at']"
                                        [ngClass]="{'form-control-danger': !_isValid(this._addPurchaseForm, this._addPurchaseFormErrors, 'invoice_created_at')}">

                                    <span class="help-block help-block-error" *ngIf="!_addPurchaseFormErrors.invoice_created_at.valid">{{_addPurchaseFormErrors.invoice_created_at.message}}</span>

                                </div>
                            </div>

                            <div class="col-md-4" *ngIf="_addPurchaseForm.controls['is_invoice'].value == '1'">
                                <div class="form-group required" [ngClass]="{'has-danger': !_isValid(this._addPurchaseForm, this._addPurchaseFormErrors, 'is_invoice_paid')}">

                                    <label class="form-control-label">Invoice Paid</label>
                                    <div style="height:34px; padding-top:5px;">
                                        <label class="radio-inline">
                                        <input type="radio" name="isInvoicePaid" [value]="1" [checked]="_addPurchaseForm.controls['is_invoice_paid'].value==='1'" [formControl]="_addPurchaseForm.controls['is_invoice_paid']" [ngClass]="{'form-control-danger': !_isValid(this._addPurchaseForm, this._addPurchaseFormErrors, 'is_invoice_paid')}">Yes
                                    </label>
                                        <label class="radio-inline">
                                        <input type="radio" name="isInvoicePaid" [value]="0" [checked]="_addPurchaseForm.controls['is_invoice_paid'].value==='0'" [formControl]="_addPurchaseForm.controls['is_invoice_paid']" [ngClass]="{'form-control-danger': !_isValid(this._addPurchaseForm, this._addPurchaseFormErrors, 'is_invoice_paid')}">No
                                    </label>
                                    </div>

                                    <span class="help-block help-block-error" *ngIf="!_addPurchaseFormErrors.is_invoice_paid.valid">{{_addPurchaseFormErrors.is_invoice_paid.message}}</span>

                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="modal-footer footer-background">
                    <button type="submit" class="btn btn-primary btn-blue" [disabled]="!_addPurchaseForm.valid || _addPurchaseFormSubmitted == true">Save</button>
                    <button type="button" class="btn btn-default" (click)="closeModal('addPurchaseModal')">Close</button>
                </div>
            </form>
        </div>
    </div>
</div>
<!-- ./Add Purchase Modal -->

<!-- Update Purchase Modal -->
<div class="modal fade" bsModal #updatePurchaseModal="bs-modal" [config]="{backdrop: 'static'}" role="dialog" aria-labelledby="updatePurchaseDetails"
    aria-hidden="true">
    <div class="modal-dialog modal-lg" style="width: 80%;">
        <div class="modal-content">
            <div class="modal-header modal-header-color">

                <button type="button" class="close-modal modal-opacity close-modal-blue" (click)="closeModal('updatePurchaseModal')">
								X
							</button>
                <h4 class="modal-title color-white" id="myModalLabel">
                    Update Purchase Details
                </h4>
            </div>
            <form [formGroup]="_updatePurchaseForm" (ngSubmit)="onSubmit(this._updatePurchaseForm)" style="margin-top:10px;">

                <div class="modal-body row">
                    <div class="col-md-12 padding-0 red">
                        {{_errorMessage}}
                    </div>
                    <div class="col-md-12 padding-0">
                        <div class="col-md-4">
                            <div class="form-group required">
                                <label class="form-control-label">Client Name</label>
                                <span class="form-control" readOnly>{{temp_client_name}}</span>
                            </div>
                        </div>

                        <div class="col-md-4">
                            <div class="form-group required">
                                <label class="form-control-label">Brand</label>
                                <span class="form-control" readOnly>{{temp_brand}}</span>
                            </div>
                        </div>

                        <div class="col-md-4">
                            <div class="form-group required">
                                <label class="form-control-label">Client #</label>
                                <span class="form-control" readOnly>{{temp_client_number}}</span>
                            </div>
                        </div>

                    </div>
                    <div class="col-md-12 padding-0">

                        <div class="col-md-4">
                            <div class="form-group required" [ngClass]="{'has-danger': !_isValid(this._updatePurchaseForm, this._updatePurchaseFormErrors, 'product_id')}">
                                <label class="form-control-label">Product</label>
                                <select class="form-control" *ngIf="temp_product == ''" [formControl]="_updatePurchaseForm.controls['product_id']" (ngModelChange)="onProductChange(this._updatePurchaseForm, $event)"
                                    [ngClass]="{'form-control-danger': !_isValid(this._updatePurchaseForm, this._updatePurchaseFormErrors, 'product_id')}">
                                    <option value='' [ngValue]='' selected>Select</option>
                                    <!-- <option *ngFor="let sp of availableProducts" [value]="sp.product_id" >{{sp.product_full_name}}</option> -->
                                    
                                    <ng-container *ngFor="let sp of selectableProducts">
                                        <option [value]="sp.product_id" *ngIf="sp.is_deleted == '0'">{{sp.product_full_name}}</option>
                                    </ng-container>
                                </select>
                                <span *ngIf="temp_product != ''" class="form-control" readOnly>{{temp_product}}</span>

                                <span class="help-block help-block-error" *ngIf="!_updatePurchaseFormErrors.product_id.valid">{{_updatePurchaseFormErrors.product_id.message}}</span>

                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group required" [ngClass]="{'has-danger': !_isValid(this._updatePurchaseForm, this._updatePurchaseFormErrors, 'total_no_eins')}">
                                <label class="form-control-label">Total # of Eins</label>
                                <input type="number" min="0" oninput="this.value=this.value.slice(0,this.maxLength)" maxLength="3" class="form-control" [formControl]="_updatePurchaseForm.controls['total_no_eins']"
                                    [ngClass]="{'form-control-danger': !_isValid(this._updatePurchaseForm, this._updatePurchaseFormErrors, 'total_no_eins')}">

                                <span class="help-block help-block-error" *ngIf="!_updatePurchaseFormErrors.total_no_eins.valid">{{_updatePurchaseFormErrors.total_no_eins.message}}</span>

                            </div>
                        </div>

                        <div class="col-md-4">
                            <div class="form-group" [ngClass]="{'has-danger': !_isValid(this._updatePurchaseForm, this._updatePurchaseFormErrors, 'total_no_forms'), 'required': !isVhtProduct}">

                                <label class="form-control-label">Total # of Forms</label>
                                <!-- <input type="number" min="0" oninput="this.value=this.value.slice(0,this.maxLength)" maxLength="6" class="form-control" [formControl]="_updatePurchaseForm.controls['total_no_forms']" [ngClass]="{'form-control-danger': !_isValid(this._updatePurchaseForm, this._updatePurchaseFormErrors, 'total_no_forms')}"> -->
                                <select class="form-control" [formControl]="_updatePurchaseForm.controls['total_no_forms']" [ngClass]="{'form-control-danger': !_isValid(this._updatePurchaseForm, this._updatePurchaseFormErrors, 'total_no_forms')}">
                                    <option value='' [ngValue]='' selected>Select</option>
                                    <option *ngFor="let nfl of no_of_forms_list" [value]="nfl.form_value" >{{nfl.form_name}}</option>
                                </select>
                                <span class="help-block help-block-error" *ngIf="!_updatePurchaseFormErrors.total_no_forms.valid">{{_updatePurchaseFormErrors.total_no_forms.message}}</span>

                            </div>
                        </div>
                    </div>
                    <div class="col-md-12 padding-0">

                        <div class="col-md-4">
                            <div class="form-group required" [ngClass]="{'has-danger': !_isValid(this._updatePurchaseForm, this._updatePurchaseFormErrors, 'purchaser_first_name')}">
                                <label class="form-control-label">Purchaser First Name</label>
                                <input type="text" oninput="this.value=this.value.replace(/[^A-Za-z ]/g, '')" maxlength="20" class="form-control" [formControl]="_updatePurchaseForm.controls['purchaser_first_name']"
                                    [ngClass]="{'form-control-danger': !_isValid(this._updatePurchaseForm, this._updatePurchaseFormErrors, 'purchaser_first_name')}">

                                <span class="help-block help-block-error" *ngIf="!_updatePurchaseFormErrors.purchaser_first_name.valid">{{_updatePurchaseFormErrors.purchaser_first_name.message}}</span>

                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group required" [ngClass]="{'has-danger': !_isValid(this._updatePurchaseForm, this._updatePurchaseFormErrors, 'purchaser_last_name')}">
                                <label class="form-control-label">Purchaser Last Name</label>
                                <input type="text" oninput="this.value=this.value.replace(/[^A-Za-z ]/g, '')" maxlength="20" class="form-control" [formControl]="_updatePurchaseForm.controls['purchaser_last_name']"
                                    [ngClass]="{'form-control-danger': !_isValid(this._updatePurchaseForm, this._updatePurchaseFormErrors, 'purchaser_last_name')}">

                                <span class="help-block help-block-error" *ngIf="!_updatePurchaseFormErrors.purchaser_last_name.valid">{{_updatePurchaseFormErrors.purchaser_last_name.message}}</span>

                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group required" [ngClass]="{'has-danger': !_isValid(this._updatePurchaseForm, this._updatePurchaseFormErrors, 'purchaser_email')}">
                                <label class="form-control-label">Purchaser Email</label>
                                <input type="text" class="form-control" maxlength="50" [formControl]="_updatePurchaseForm.controls['purchaser_email']" [ngClass]="{'form-control-danger': !_isValid(this._updatePurchaseForm, this._updatePurchaseFormErrors, 'purchaser_email')}">

                                <span class="help-block help-block-error" *ngIf="!_updatePurchaseFormErrors.purchaser_email.valid">{{_updatePurchaseFormErrors.purchaser_email.message}}</span>

                            </div>
                        </div>
                    </div>
                    <div class="col-md-12 padding-0">

                        <div class="col-md-4">
                            <div class="form-group required" [ngClass]="{'has-danger': !_isValid(this._updatePurchaseForm, this._updatePurchaseFormErrors, 'purchaser_mobile')}">

                                <label class="form-control-label">Purchaser Phone</label>
                                <input type="text" [textMask]="{mask: mask,guide: false, modelClean: true}" [formControl]="_updatePurchaseForm.controls['purchaser_mobile']"
                                    class="form-control" placeholder="(___) ___-____" [ngClass]="{'form-control-danger': !_isValid(this._updatePurchaseForm, this._updatePurchaseFormErrors, 'purchaser_mobile')}">

                                <span class="help-block help-block-error" *ngIf="!_updatePurchaseFormErrors.purchaser_mobile.valid">{{_updatePurchaseFormErrors.purchaser_mobile.message}}</span>

                            </div>
                        </div>

                        <div class="col-md-4">
                            <div class="form-group required" [ngClass]="{'has-danger': !_isValid(this._updatePurchaseForm, this._updatePurchaseFormErrors, 'purchase_status')}">

                                <label class="form-control-label">Purchased Status</label>
                                <div style="height:34px; padding-top:5px;">
                                    <label class="radio-inline">
                                        <input type="radio" name="purchasedStatus" [value]="1" [checked]="_updatePurchaseForm.controls['purchase_status'].value==='1'" [formControl]="_updatePurchaseForm.controls['purchase_status']" [ngClass]="{'form-control-danger': !_isValid(this._updatePurchaseForm, this._updatePurchaseFormErrors, 'purchase_status')}">Active
                                    </label>
                                    <label class="radio-inline">
                                        <input type="radio" name="purchasedStatus" [value]="0" [checked]="_updatePurchaseForm.controls['purchase_status'].value==='0'" [formControl]="_updatePurchaseForm.controls['purchase_status']" [ngClass]="{'form-control-danger': !_isValid(this._updatePurchaseForm, this._updatePurchaseFormErrors, 'purchase_status')}">Inactive
                                    </label>
                                </div>

                                <span class="help-block help-block-error" *ngIf="!_updatePurchaseFormErrors.purchase_status.valid">{{_updatePurchaseFormErrors.purchase_status.message}}</span>

                            </div>
                        </div>

                        <div class="col-md-4">
                            <div class="form-group required" [ngClass]="{'has-danger': !_isValid(this._updatePurchaseForm, this._updatePurchaseFormErrors, 'amount')}">
                                <label class="form-control-label">Amount</label>
                                <input type="text" OnlyAmountNumber="true" DecimalPlaces="2" minValue="1.00" maxValue="999999.00" class="form-control" [formControl]="_updatePurchaseForm.controls['amount']"
                                    [ngClass]="{'form-control-danger': !_isValid(this._updatePurchaseForm, this._updatePurchaseFormErrors, 'amount')}">

                                <span class="help-block help-block-error" *ngIf="!_updatePurchaseFormErrors.amount.valid">{{_updatePurchaseFormErrors.amount.message}}</span>

                            </div>
                        </div>

                    </div>
                    <div class="col-md-12 padding-0">
                        <div class="col-md-4" *ngIf="show_account_manager == '1'">
                            <div class="form-group required" [ngClass]="{'has-danger': !_isValid(this._updatePurchaseForm, this._updatePurchaseFormErrors, 'account_manager')}">

                                <label class="form-control-label">Assign Account Manager</label>
                                <select class="form-control" [formControl]="_updatePurchaseForm.controls['account_manager']" [ngClass]="{'form-control-danger': !_isValid(this._updatePurchaseForm, this._updatePurchaseFormErrors, 'account_manager')}">
                                    <option value='' [ngValue]='' selected>Select</option>
                                    <option *ngFor="let am of availableAcctManagers" [value]="am.admin_user_id" >{{am.first_name}} {{am.last_name}}</option>
                                </select>

                                <span class="help-block help-block-error" *ngIf="!_updatePurchaseFormErrors.account_manager.valid">{{_updatePurchaseFormErrors.account_manager.message}}</span>

                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group required" [ngClass]="{'has-danger': !_isValid(this._updatePurchaseForm, this._updatePurchaseFormErrors, 'purchase_date')}">

                                <label class="form-control-label">Date of Purchase</label>
                                <input type="date" max="9999-12-31" class="form-control" [formControl]="_updatePurchaseForm.controls['purchase_date']" [ngClass]="{'form-control-danger': !_isValid(this._updatePurchaseForm, this._updatePurchaseFormErrors, 'purchase_date')}">

                                <span class="help-block help-block-error" *ngIf="!_updatePurchaseFormErrors.purchase_date.valid">{{_updatePurchaseFormErrors.purchase_date.message}}</span>

                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group required" [ngClass]="{'has-danger': !_isValid(this._updatePurchaseForm, this._updatePurchaseFormErrors, 'is_invoice')}">

                                <label class="form-control-label">Invoice</label>
                                <div style="height:34px; padding-top:5px;">
                                    <label class="radio-inline">
                                        <input type="radio" name="isInvoice" [value]="1" (click)="toggleInvoiceFieldsValidator(this._updatePurchaseForm, true)" [checked]="_updatePurchaseForm.controls['is_invoice'].value==='1'" [formControl]="_updatePurchaseForm.controls['is_invoice']" [ngClass]="{'form-control-danger': !_isValid(this._updatePurchaseForm, this._updatePurchaseFormErrors, 'is_invoice')}">Yes
                                    </label>
                                    <label class="radio-inline">
                                        <input type="radio" name="isInvoice" [value]="0" (click)="toggleInvoiceFieldsValidator(this._updatePurchaseForm, false)" [checked]="_updatePurchaseForm.controls['is_invoice'].value==='0'" [formControl]="_updatePurchaseForm.controls['is_invoice']" [ngClass]="{'form-control-danger': !_isValid(this._updatePurchaseForm, this._updatePurchaseFormErrors, 'is_invoice')}">No
                                    </label>
                                </div>

                                <span class="help-block help-block-error" *ngIf="!_updatePurchaseFormErrors.is_invoice.valid">{{_updatePurchaseFormErrors.is_invoice.message}}</span>

                            </div>
                        </div>
                        <div class="col-md-12 padding-0">
                            <div class="col-md-4" *ngIf="_updatePurchaseForm.controls['is_invoice'].value == '1'">
                                <div class="form-group required" [ngClass]="{'has-danger': !_isValid(this._updatePurchaseForm, this._updatePurchaseFormErrors, 'invoice_no')}">
                                    <label class="form-control-label">Invoice #</label>
                                    <input type="text" invoiceNumber="true" maxlength="30" class="form-control" [formControl]="_updatePurchaseForm.controls['invoice_no']" [ngClass]="{'form-control-danger': !_isValid(this._updatePurchaseForm, this._updatePurchaseFormErrors, 'invoice_no')}">

                                    <span class="help-block help-block-error" *ngIf="!_updatePurchaseFormErrors.invoice_no.valid">{{_updatePurchaseFormErrors.invoice_no.message}}</span>

                                </div>
                            </div>
                            <div class="col-md-4" *ngIf="_updatePurchaseForm.controls['is_invoice'].value == '1'">
                                <div class="form-group required" [ngClass]="{'has-danger': !_isValid(this._updatePurchaseForm, this._updatePurchaseFormErrors, 'invoice_created_at')}">
                                    <label class="form-control-label">Invoice Date</label>
                                    <input type="date" max="9999-12-31" class="form-control" [formControl]="_updatePurchaseForm.controls['invoice_created_at']"
                                        [ngClass]="{'form-control-danger': !_isValid(this._updatePurchaseForm, this._updatePurchaseFormErrors, 'invoice_created_at')}">

                                    <span class="help-block help-block-error" *ngIf="!_updatePurchaseFormErrors.invoice_created_at.valid">{{_updatePurchaseFormErrors.invoice_created_at.message}}</span>

                                </div>
                            </div>

                            <div class="col-md-4" *ngIf="_updatePurchaseForm.controls['is_invoice'].value == '1'">
                                <div class="form-group required" [ngClass]="{'has-danger': !_isValid(this._updatePurchaseForm, this._updatePurchaseFormErrors, 'is_invoice_paid')}">

                                    <label class="form-control-label">Invoice Paid</label>
                                    <div style="height:34px; padding-top:5px;">

                                        <label class="radio-inline">
                                        <input type="radio" name="isInvoicePaid" [value]="1" [checked]="_updatePurchaseForm.controls['is_invoice_paid'].value==='1'" [formControl]="_updatePurchaseForm.controls['is_invoice_paid']" [ngClass]="{'form-control-danger': !_isValid(this._updatePurchaseForm, this._updatePurchaseFormErrors, 'is_invoice_paid')}">Yes
                                    </label>
                                        <label class="radio-inline">
                                        <input type="radio" name="isInvoicePaid" [value]="0" [checked]="_updatePurchaseForm.controls['is_invoice_paid'].value==='0'" [formControl]="_updatePurchaseForm.controls['is_invoice_paid']" [ngClass]="{'form-control-danger': !_isValid(this._updatePurchaseForm, this._updatePurchaseFormErrors, 'is_invoice_paid')}">No
                                    </label>
                                    </div>

                                    <span class="help-block help-block-error" *ngIf="!_updatePurchaseFormErrors.is_invoice_paid.valid">{{_updatePurchaseFormErrors.is_invoice_paid.message}}</span>

                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="modal-footer footer-background">
                    <button type="submit" class="btn btn-primary btn-blue" [disabled]="!_updatePurchaseForm.valid || _updatePurchaseFormSubmitted == true">Save</button>
                    <button type="button" class="btn btn-default" (click)="closeModal('updatePurchaseModal')">Close</button>
                </div>
            </form>
        </div>
    </div>
</div>
<!-- ./Update Purchase Modal -->

<!-- Close confirmation Modal -->
<app-close-modal-confirmation #closeConfirmationModal (confirmed)="okClose()"></app-close-modal-confirmation>
<!-- Delete confirmation Modal -->
<app-delete-confirmation #deleteModal (confirmed)="okDelete()"></app-delete-confirmation>